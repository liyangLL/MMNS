<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PM2.5ÁßªÂä®ÁõëÊµãÂú∞ÂõæÁ≥ªÁªü</title>
  <link rel="stylesheet" href="https://js.geoscene.cn/4.29/geoscene/themes/light/main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body>
  <!-- È°∂ÈÉ®Ê†áÈ¢òÊ†è -->
  <div class="header">
    <div class="logo">
      <div class="logo-icon">PM</div>
      <div class="logo-text">
        <h1>PM2.5 Mobile Monitoring System</h1>
        <p>Real-time monitoring platform for road pollutant concentration</p>
      </div>
    </div>
    <div class="system-info">
      <div class="status-indicator running" id="systemStatus">
        <div class="indicator running"></div>
        <span>Monitoring in operation</span>
      </div>
    </div>
  </div>

  <!-- ‰∏ªÂÆπÂô® -->
  <div class="main-container">
    <!-- Â∑¶‰æßËèúÂçï -->
    <div class="sidebar">
      <div class="menu-title">Menu</div>
      <div class="menu-item active" data-target="home">
        <i>üè†</i>
        <span>Home</span>
      </div>
      <div class="menu-item" data-target="trajector">
        <i>üõ∞Ô∏è</i>
        <span>Movement Track</span>
      </div>
      <div class="menu-item" data-target="raster">
        <i>üåê</i>
        <span>Grille Map</span>
      </div>
      <div class="menu-item" data-target="stats">
        <i>üìä</i>
        <span>Statistics</span>
      </div>
      <div class="menu-item" data-target="devices">
        <i>üì±</i>
        <span>Devices</span>
      </div>
      <div class="menu-item" data-target="control">
        <i>‚öôÔ∏è</i>
        <span>System Control</span>
      </div>
      <div class="menu-item" data-target="info">
        <i>‚ÑπÔ∏è</i>
        <span>Information</span>
      </div>
    </div>

    <!-- ÂÜÖÂÆπÂå∫Âüü -->
    <div class="content-area">
      <!-- ‰∏ªÈ°µÂÜÖÂÆπ - Âú∞Âõæ -->
      <div class="content-panel active" id="homeContent">
        <div class="map-container">
          <div id="viewDiv">
            <div class="loading-overlay" id="loadingOverlay">
              <div class="loading-spinner"></div>
            </div>
          </div>
          <!-- APIÁä∂ÊÄÅ -->
          <div class="api-status">
            <div class="api-indicator" id="apiIndicator"></div>
            <span>API Status:<span id="apiStatusText">Connecting...</span></span>
          </div>
          <div class="legend">
            <div class="legend-title">Air quality indicators</div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #2ecc71;"></div>
              <div class="legend-label">Good(0-35 Œºg/m¬≥)</div>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #f1c40f;"></div>
              <div class="legend-label">Slight(36-75 Œºg/m¬≥)</div>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #e67e22;"></div>
              <div class="legend-label">Mod(76-115 Œºg/m¬≥)</div>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #e74c3c;"></div>
              <div class="legend-label">Severe(116+ Œºg/m¬≥)</div>
            </div>
          </div>
          <div class="status-bar">
            <div class="indicator"></div>
            <span>Time: <span id="mapLastUpdate">2025-07-18 14:28:45</span></span>
          </div>
        </div>
      </div>


      <div class="content-panel" id="trajectorContent">
        <div class="map-container">
          <div class="trajectory-header">
            <input class = "filter-input" type="text" id="trajectoryFilter" placeholder="Search device ID...">
            <button id="loadTrajectoryBtn">Loading</button>
            <button id="clearTrajectoryBtn">Clear</button>
          </div>
          <div id="trajectorDiv">
            <div class="legend">
            <div class="legend-title">Air quality indicators</div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #2ecc71;"></div>
              <div class="legend-label">Good(0-35 Œºg/m¬≥)</div>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #f1c40f;"></div>
              <div class="legend-label">Slight(36-75 Œºg/m¬≥)</div>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #e67e22;"></div>
              <div class="legend-label">Mod(76-115 Œºg/m¬≥)</div>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #e74c3c;"></div>
              <div class="legend-label">Severe(116+ Œºg/m¬≥)</div>
            </div>
          </div>
          </div>
        </div>
     
      </div>
      
      <!-- ËÆæÂ§áÁÆ°ÁêÜÈù¢Êùø -->
      <div class="content-panel" id="devicesContent">
        <div class="devices-header">
          <div class="devices-title">
            <i class="fas fa-mobile-alt"></i>
            <h2>Monitoring devices</h2>
          </div>
          <div class="devices-filter">
            <input type="text" class="filter-input" id="deviceFilter" placeholder="Search device ID...">
            <select class="filter-input" id="statusFilter">
              <option value="all">All Status</option>
              <option value="good">Good</option>
              <option value="moderate">Slight</option>
              <option value="unhealthy">Moderate</option>
              <option value="hazardous">Severe</option>
            </select>
          </div>
        </div>
        
        <div class="devices-grid" id="devicesGrid">
          <!-- ËÆæÂ§áÂç°ÁâáÂ∞ÜÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
        </div>
      </div>

      <!-- Á≥ªÁªüÊéßÂà∂Èù¢Êùø -->
      <div class="content-panel" id="controlContent">
        <div class="control-panel">
          <div class="panel-section" id="panelSection">
            <div class="section-title">
              <i>‚öôÔ∏è</i>
              <h2>System control panel</h2>
            </div>
            
            <div class="status-indicator-panel">
              <div class="indicator-panel" id="statusIndicator"></div>
              <span id="statusText">Monitoring in operation</span>
            </div>
            
            <div class="control-buttons">
              <button class="control-btn btn-primary" id="startBtn">
                <span>‚ñ∂Ô∏è</span> Start monitoring
              </button>
              <button class="control-btn btn-warning" id="pauseBtn">
                <span>‚è∏Ô∏è</span> Pause monitoring
              </button>
              <button class="control-btn btn-danger" id="clearBtn">
                <span>üóëÔ∏è</span> Clear Data
              </button>
              <button class="control-btn btn-primary" id="addPointBtn">
                <span>üîÉ</span> Manual Update
              </button>
            </div>
            
            <div class="slider-container">
              <div class="slider-label">
                <span>Update frequency</span>
                <span id="freqValue">5 s</span>
              </div>
              <input type="range" min="1" max="10" value="5" id="freqSlider">
            </div>
          </div>
        </div>
      </div>

      <!-- Êï∞ÊçÆÁªüËÆ°Èù¢Êùø -->
      <div class="content-panel" id="statsContent">
        <div class="data-panel">
          <div class="panel-section">
            <div class="section-title">
              <i>üìä</i>
              <h2>Statistics</h2>
            </div>
            
            <div class="data-stats">
              <div class="data-stat">
                <h3>Number of monitoring points</h3>
                <div class="value" id="pointsCount">0</div>
              </div>
              <div class="data-stat">
                <h3>Total data</h3>
                <div class="value" id="dataCount">0</div>
              </div>
              <div class="data-stat">
                <h3>Run time</h3>
                <div class="value" id="uptime">00:00:00</div>
              </div>
              <div class="data-stat">
                <h3>Last Updated</h3>
                <div class="value" id="lastUpdate">--:--:--</div>
              </div>
            </div>
          </div>
          
          <div class="panel-section" style="grid-column: span 2;">
            <div class="section-title">
              <i>üìù</i>
              <h2>Received data</h2>
            </div>
            
            <div class="data-output-container">
              <div class="data-output-title">
                <span>Real-time data streaming</span>
                <button class="clear-data-btn" id="clearOutputBtn">Ê∏ÖÈô§</button>
              </div>
              <div class="data-output" id="dataOutput">
                <div>[System] Initializing monitoring system...</div>
              </div>
            </div>
          </div>
          <div class="panel-section" style="grid-column: span 2;">
            <div class="section-title">
              <i>üìà</i>
              <h2>Data trend chart</h2>
              <div class="filter-part">
                    <input type="date" id="startDate" class="filter-input" placeholder="Start date">
                    <input type="date" id="endDate" class="filter-input" placeholder="End date">
                    <input class = "filter-input" type="text" id="carFilter" placeholder="Search vehicle ID...">
                    <button class="refresh-chart-btn" id="refreshChartBtn" >
                      <i class="fas fa-sync-alt"></i> Refresh
                    </button>
              </div>         
            </div>
            <div class="chart-container" id ="chartContainer">
              <!-- <canvas id="dataChart"></canvas> -->
            </div>
          </div>
          
          <div class="panel-section" style="grid-column: span 2;">
            <div class="section-title">
              <i>üìç</i>
              <h2>Concentration ranking</h2>
              <button class="refresh-rank-btn" id="refreshRankBtn" >
              <i class="fas fa-sync-alt"></i> Refresh
              </button>
            </div>
           
            <div class="rank-container" id ="rankContainer">
              <canvas id="dataChart"></canvas>
            </div>
           


           </div>
        </div>
      </div>
      
      <!-- Á≥ªÁªü‰ø°ÊÅØÈù¢Êùø -->
      <div class="content-panel" id="infoContent">
        <div class="system-info-panel">
          <div class="info-header">
            <h2>System Information</h2>
            <p>Technical Details</p>
          </div>
          
          <div class="info-grid">
            <div class="info-card">
              <h3>System Status</h3>
              <p><strong>Running status: </strong>Normal</p>
              <p><strong>Last updated: </strong>2025-7-16 14:30:22</p>
              <p><strong>System Load: </strong>52.0%</p>
            </div>
            
            <div class="info-card">
              <h3>Version Information</h3>
              <p><strong>Software Version: </strong>v5.2.0</p>
              <p><strong>Map Engine: </strong>Geoscene 4.29</p>
              <p><strong>Database: </strong>MySQL 8.0.32</p>
            </div>
            
            <div class="info-card">
              <h3>Service Connection</h3>
              <p><strong>Data API: </strong>http://localhost:5000/data</p>
              <p><strong>Map Services: </strong>http://localhost:5000/map</p>
              <p><strong>Grille Services: </strong>http://localhost:5000/raster</p>
              <p><strong>State: </strong>All services connected normally</p>
            </div>
            
            <div class="info-card">
              <h3>Technical Support</h3>
              <p><strong>Unit: </strong>CUGB</p>
              <p><strong>Contact: </strong>Li_Yang</p>
              <p><strong>Email: </strong>3219522051@qq.com</p>
            </div>
            
            <div class="info-card" style="grid-column: span 2;">
              <h3>Functional description</h3>
              <p>This system provides functions such as real-time monitoring of PM2.5, historical data analysis, and road emission estimation.</p>
            </div>
            

          </div>
        </div>
      </div>
      
      <!-- Ê†ºÊ†ÖÂú∞ÂõæÈù¢Êùø -->
      <div class="content-panel" id="rasterContent">
        <div class="raster-container">
          <div class="raster-header">
            <h2><i class="fas fa-layer-group"></i>PM2.5 grid map</h2>
            <div class="raster-controls">
              <button class="raster-btn" id="refreshRasterBtn">
                <i class="fas fa-sync-alt"></i> Refresh Data
              </button>
              <div class="time-info">
                Last updated:<span id="rasterLastUpdate">--:--:--</span>
              </div>
            </div>
          </div>
          <div class="raster-map-container">
            <img id="rasterImage" alt="PM2.5 Grid map">
            <div class="loading-overlay" id="rasterLoadingOverlay" style="display: none;">
              <div class="loading-spinner"></div>
              <p>Loading grid data...</p>
            </div>
          </div>
          <div class="raster-legend">
            <div class="legend-title">PM2.5 concentration level (Œºg/m¬≥)</div>
            <div class="legend-items">
              <div class="legend-item">
                <div class="legend-color" style="background-color: #00b050;"></div>
                <div class="legend-label">0-35</div>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background-color: #92d050;"></div>
                <div class="legend-label">36-55</div>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background-color: #ffff00;"></div>
                <div class="legend-label">56-75</div>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background-color: #ff9900;"></div>
                <div class="legend-label">76-115</div>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background-color: #ff0000;"></div>
                <div class="legend-label">116-150</div>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background-color: #c00000;"></div>
                <div class="legend-label">151-250</div>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background-color: #800080;"></div>
                <div class="legend-label">250+</div>
              </div>
            </div>
          </div>
          <div class="raster-stats">
            <div class="stat-item">
              <i class="fas fa-chart-bar"></i>
              <span>Maximum concentration: <strong id="maxPm25">--</strong> Œºg/m¬≥</span>
            </div>
            <div class="stat-item">
              <i class="fas fa-chart-line"></i>
              <span>Average concentration: <strong id="avgPm25">--</strong> Œºg/m¬≥</span>
            </div>
            <div class="stat-item">
              <i class="fas fa-map-marker-alt"></i>
              <span>Coverage area: <strong id="coverageArea">--</strong> km¬≤</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://js.geoscene.cn/4.29/"></script>
  <script src="script.js"></script>
</body>
</html>
